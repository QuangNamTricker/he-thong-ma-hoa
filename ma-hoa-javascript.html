<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trình Mã Hóa JavaScript với Mật Khẩu</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            width: 100%;
            max-width: 900px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(90deg, #3498db, #2c3e50);
            color: white;
            text-align: center;
            padding: 25px 20px;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .description {
            font-size: 1rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            padding: 20px;
        }
        
        .input-section, .output-section {
            flex: 1;
            min-width: 300px;
            padding: 20px;
        }
        
        .section-title {
            font-size: 1.3rem;
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        
        textarea {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
        }
        
        textarea:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .options {
            margin: 20px 0;
        }
        
        .option-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        .password-container {
            margin: 15px 0;
        }
        
        .password-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            margin-top: 5px;
        }
        
        .method-badge {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .encode-btn {
            background: linear-gradient(90deg, #3498db, #2980b9);
            color: white;
            flex: 2;
        }
        
        .encode-btn:hover {
            background: linear-gradient(90deg, #2980b9, #2573a7);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .clear-btn {
            background: linear-gradient(90deg, #e74c3c, #c0392b);
            color: white;
            flex: 1;
        }
        
        .clear-btn:hover {
            background: linear-gradient(90deg, #c0392b, #a93226);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .output {
            position: relative;
        }
        
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 8px 15px;
            background: #2ecc71;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .copy-btn:hover {
            background: #27ae60;
        }
        
        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px;
            margin-top: 20px;
            border-radius: 0 5px 5px 0;
        }
        
        .info-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-size: 0.9rem;
            background: #f8f9fa;
            border-top: 1px solid #ddd;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Trình Mã Hóa JavaScript với Mật Khẩu</h1>
            <p class="description">Bảo vệ mã JavaScript của bạn bằng Base64 kết hợp mật khẩu</p>
        </header>
        
        <div class="main-content">
            <div class="input-section">
                <h2 class="section-title">Mã JavaScript gốc</h2>
                <textarea id="inputCode" placeholder="Nhập mã JavaScript của bạn vào đây...">function calculate(a, b) {
  // Hàm tính tổng hai số
  const result = a + b;
  console.log("Kết quả: " + result);
  return result;
}

// Gọi hàm với các giá trị mẫu
calculate(5, 7);</textarea>
                
                <div class="options">
                    <div class="option-title">Phương pháp mã hóa</div>
                    <div class="method-badge">Base64 với Mật khẩu (Hoạt động trên mọi website)</div>
                    
                    <div class="password-container">
                        <div class="option-title">Mật khẩu mã hóa (bắt buộc):</div>
                        <input type="password" id="password" class="password-input" placeholder="Nhập mật khẩu mạnh...">
                    </div>
                </div>
                
                <div class="buttons">
                    <button class="encode-btn" onclick="encodeCode()">Mã Hóa JavaScript</button>
                    <button class="clear-btn" onclick="clearCode()">Xóa Mã</button>
                </div>
                
                <div class="info-box">
                    <div class="info-title">Lưu ý quan trọng:</div>
                    <p>Mã hóa Base64 kết hợp mật khẩu giúp bảo vệ mã JavaScript của bạn. Người khác sẽ không thể giải mã nếu không có mật khẩu, nhưng website của bạn vẫn hoạt động bình thường.</p>
                </div>
            </div>
            
            <div class="output-section">
                <h2 class="section-title">Mã đã mã hóa</h2>
                <div class="output">
                    <textarea id="outputCode" readonly placeholder="Kết quả mã hóa sẽ xuất hiện ở đây..."></textarea>
                    <button class="copy-btn" onclick="copyToClipboard()">Sao chép</button>
                </div>
                
                <div class="info-box">
                    <div class="info-title">Hướng dẫn sử dụng:</div>
                    <p>1. Nhập mã JavaScript vào ô bên trái</p>
                    <p>2. Nhập mật khẩu mạnh (ít nhất 8 ký tự)</p>
                    <p>3. Nhấn nút "Mã Hóa JavaScript"</p>
                    <p>4. Sao chép kết quả và sử dụng trong website của bạn</p>
                    <p>5. Đảm bảo sử dụng cùng mật khẩu khi giải mã</p>
                </div>
            </div>
        </div>
        
        <footer>
            <p>© 2023 Trình Mã Hóa JavaScript với Mật Khẩu - Giải pháp bảo mật đáng tin cậy</p>
        </footer>
    </div>

    <script>
        // Hàm mã hóa chuỗi với mật khẩu sử dụng XOR
        function xorEncrypt(text, password) {
            let encrypted = '';
            for (let i = 0; i < text.length; i++) {
                const keyChar = password.charCodeAt(i % password.length);
                const textChar = text.charCodeAt(i);
                encrypted += String.fromCharCode(textChar ^ keyChar);
            }
            return encrypted;
        }
        
        // Hàm giải mã chuỗi với mật khẩu sử dụng XOR
        function xorDecrypt(encryptedText, password) {
            let decrypted = '';
            for (let i = 0; i < encryptedText.length; i++) {
                const keyChar = password.charCodeAt(i % password.length);
                const encryptedChar = encryptedText.charCodeAt(i);
                decrypted += String.fromCharCode(encryptedChar ^ keyChar);
            }
            return decrypted;
        }
        
        function encodeCode() {
            const inputCode = document.getElementById('inputCode').value;
            const password = document.getElementById('password').value;
            
            if (!inputCode.trim()) {
                alert('Vui lòng nhập mã JavaScript trước khi mã hóa!');
                return;
            }
            
            if (!password.trim()) {
                alert('Vui lòng nhập mật khẩu để mã hóa!');
                return;
            }
            
            if (password.length < 4) {
                alert('Mật khẩu phải có ít nhất 4 ký tự!');
                return;
            }
            
            // Mã hóa Base64 với mật khẩu
            const encodedCode = encodeBase64WithPassword(inputCode, password);
            
            document.getElementById('outputCode').value = encodedCode;
        }
        
        function encodeBase64WithPassword(code, password) {
            // Mã hóa bằng XOR với mật khẩu trước
            const encryptedWithPassword = xorEncrypt(code, password);
            
            // Sau đó mã hóa Base64
            const base64Code = btoa(unescape(encodeURIComponent(encryptedWithPassword)));
            
            // Tạo mã giải mã
            return `// Mã JavaScript đã được mã hóa Base64 với mật khẩu
(function() {
  const encodedJS = "${base64Code}";
  const password = "${password}";
  
  // Giải mã và thực thi
  try {
    const decodedBase64 = decodeURIComponent(escape(atob(encodedJS)));
    
    // Hàm giải mã XOR
    function xorDecrypt(encryptedText, pwd) {
      let decrypted = '';
      for (let i = 0; i < encryptedText.length; i++) {
        const keyChar = pwd.charCodeAt(i % pwd.length);
        const encryptedChar = encryptedText.charCodeAt(i);
        decrypted += String.fromCharCode(encryptedChar ^ keyChar);
      }
      return decrypted;
    }
    
    const finalCode = xorDecrypt(decodedBase64, password);
    eval(finalCode);
  } catch (error) {
    console.error("Lỗi giải mã: Sai mật khẩu hoặc mã không hợp lệ", error);
  }
})();`;
        }
        
        function clearCode() {
            document.getElementById('inputCode').value = '';
            document.getElementById('outputCode').value = '';
            document.getElementById('password').value = '';
        }
        
        function copyToClipboard() {
            const outputCode = document.getElementById('outputCode');
            if (!outputCode.value.trim()) {
                alert('Không có nội dung để sao chép!');
                return;
            }
            
            outputCode.select();
            document.execCommand('copy');
            
            alert('Đã sao chép mã đã mã hóa vào clipboard!');
        }
        
        // Tự động mã hóa khi trang được tải
        window.onload = function() {
            const sampleCode = document.getElementById('inputCode').value;
            const encodedCode = encodeBase64WithPassword(sampleCode, "mật_khẩu_mẫu");
            document.getElementById('outputCode').value = encodedCode;
        };
    </script>
</body>
</html>
